<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
  Cross-spectra bewteen lensing, compton-y, and filaments.
  </title>

  <link rel="stylesheet" href="styles.css">

    <!-- MathJax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <!-- MathJax equation numbering -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
      TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>


</head>

  <body>
<script type="text/javascript" src="scripts/pager.js"></script>
<link rel="stylesheet" type="text/css" href="scripts/pager.css">

  <div class="container content">

      <main>
        <article class="page">
  <h1 id='top' class="page-title"> Cosmic filaments, the CMB perspective. </h1>
  <p class="page-author"> F. Bianchini</p>
  <p class="page-date"> 13 July 2021. </p>

<h2>Context and scope</h2>

<p>
In this posting we will look at the imprint of cosmic filaments, the intricate web of structure formed by the matter distribution, on CMB lensing and Compton-$y$ maps, which probe the integrated matter and electronic pressure distribution out to high redshift.
</p> 
<p>
One motivation behind this kind of analysis is the study of the <i>missing-baryon problem</i>, the fact that CMB and BBN data predict a larger baryonics energy density than observed so far in the local Universe.
A possible explanation is that a large fraction (30 − 50%) of baryons reside in a warm-hot intergalactic medium (WHIM) phase, with temperatures in
the range $T_{\rm whim} = 10^{5−7}$ K, too warm to absorb efficiently and too cold to emit X-rays. While CMB lensing-filaments cross-correlations can tell us about the filaments bias, i.e. how filaments trace the underlying
matter distribution, the Compton-$y$ - filaments signal should depend in principle on the free baryon fraction.
</p>

<p>Two previous analyses have looked at the filamentary signal in compton-$y$ maps by stacking them at the location of (spec-$z$) galaxies, see <a href="https://arxiv.org/abs/1709.05024"> Tanimura+19</a> and <a href="https://arxiv.org/abs/1709.10378"> de
     Graaff+19</a>. 
In the harmonic domain, <a href="https://export.arxiv.org/pdf/1709.02543v2"> He+18</a> have measured the cross-correlation signal (cross-power spectrum) between filaments and CMB lensing convergence map. 
Here we follow the second approach and apply it to <i>Planck</i> compton-$y$ maps.
</p>

<hr>

<h2>Filaments intensity maps</h2>
<p>
    Here I'm using a recently publicly released <a href="https://www.javiercarron.com/catalogue"> filaments catalogue</a> extracted from spectroscopic SDSS galaxy data (BOSS and eBOSS). 
    The filaments are detected by applying a version of the Subspace-Constrained Mean Shift boosted with Machine Learning Techniques to thin slices of the redshift component in a tomographic
    analysis (in a nutshell, filaments are found in each redshift bin as the density ridge of the smoothed galaxy density field).
</p>
<p>
    The catalogue is divided into 3 blocks, depending on the data used:
    <ul>
    <li >Block 1: using BOSS (mainly LOWZ) data, with $0.05 < z < 0.45$. Only points in the LOWZ footprint are used, in both Galactic Hemispheres.</li>
    <li> Block 2: using BOSS CMASS data, with redshift $0.45 < z < 0.7$, in both Galactic Hemispheres. </li>
    <li>Block 3: using BOSS+eBOSS data (LRG and QSO), with redshift between $0.6 < z < 2.2$. Only points in the smaller eBOSS footprint are used, in the North Galactic Hemisphere only.</li>
    </ul>
</p>
<p>
    I follow <a href="https://export.arxiv.org/pdf/1709.02543v2"> He+18</a> and define the <i>filament intensity</i> as
    $$
    I(\hat{n}, z)=\frac{1}{\sqrt{2 \pi \rho_{f}(\hat{n}, z)^{2}}} \exp \left(-\frac{\left\|\hat{n}-\hat{\Pi}_{f}(\hat{n},z)\right\|^{2}}{2 \rho_{f}(\hat{n}, z)^{2}}\right),
    $$
    where $\hat{\Pi}_{f}(\hat{n},z)$ is the angular position of the closest point to $\hat{n}$ on the nearest filament and $\rho_{f}(\hat{n}, z)^{2}$ is the uncertainty of the filament at the projected position $\hat{\Pi}_{f}(\hat{n},z)$.
</p>



<figure>
    <img alt="fils pager" id="fils_pager" src="#" />
    <figcaption>
        This pager shows the filaments intensity maps in each redshift slice ($\Delta z \approx 0.005$) in equatorial coordinates. Note that not
         all of the samples have 166 slices, LOWZ has 78, CMASS has 40, and eBOSS has 166.   
    </figcaption>
    <script type="text/javascript">
        pager.link("#fils_pager",
            {
                'Sample|sample': ['BOSS LOWZ|1','BOSS CMASS|2','BOSS+eBOSS (LRG and QSO)|3'],
                'Redshift slice|z': ['0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165'],
            },
            function (params) {
                return 'plots/fils_block' + params['sample'] + '_' + params['z'] + '.png';
            });
        pager.setparams({
            'sample':'2',
            'z': '0',
        });
    </script>
</figure>

<p>
    With the intensity maps at each redshift bin, we can then construct the filament intensity overdensity map as
    $$
    \delta_{f}(\hat{n})=\frac{\int I(\hat{n}, z) d z-\bar{I}}{\bar{I}}, \quad \bar{I}=\frac{\int I(\hat{n}, z) d\Omega_{\hat{\imath}} d z}{\int d \Omega_{\hat{\imath}}}.
    $$
    We will use the overdensity map $\delta_{f}(\hat{n})$ to measure the cross-correlation with lensing and compton-$y$.
</p>

<p>
    In the following we will make use of two set of masks:
    <ul>
        <li>Baseline mask: defined by the combination of the SDSS filaments footprint and the Compton-$y$ and CMB lensing masks (Galactic masks + pt srcs)</li>
        <li>Baseline mask + SDSS redMaPPer cluster: in order to test the impact of clusters at the intersection of filaments on our signal we combine the map above with one where we mask out SDSS redMaPPer clusters out to 5 arcmin </li>
    </ul>

    In addition, we will also measure the cross-correlation signals with filament maps constructed from catalogs that contain filaments at different reliability thresholds. 
</p>

<hr>

<h2>Few notes about the analysis</h2>
<ul>
    <li>Power spectra are extracted using <code>NaMaster</code> (all fields involved are spin-0)</li>
    <li>Maps are produced at an <code>HEALPix</code> resolution of <code>Nside=512</code></li>
    <li>Gaussian approximation to estimate the covariance matrix (i.e. error bars)</li>
</ul>

<hr>

<h2>Cross-correlation with CMB lensing</h2>
<p>
    We start by cross-correlating the filament overdensity map with the (minimum-variance) CMB lensing map from <i>Planck</i>. 
    Note that this is similar to what done in <a href="https://export.arxiv.org/pdf/1709.02543v2"> He+18</a>, although they used a different filaments catalogue (also based on spec-$z$ SDSS data) and the <i>Planck</i> 2015 CMB lensing map, so this will serve as a consistency check.
</p>
    <figure>
    <img alt="kf pager" id="kf_pager" src="#" />
    <figcaption>
    Cross-power spectrum between Planck 2018 MV CMB lensing map and the filaments
    </figcaption>
        <script type="text/javascript">
            pager.link("#kf_pager",
                {
                    'Plot type |ptype01' : ['Spectrum|clkf', 'Corr coeff|clkf_corr'],
                    'Sample|sample01': ['BOSS LOWZ|1', 'BOSS CMASS|2', 'BOSS+eBOSS (LRG and QSO)|3'],
                    'Filaments uncertainty threshold|unc01': ['70', '100'],
                    'Mask|mask01' : ['base|base', 'base + SDSS redmapper clusts|base+redmapper5am'],
                },
                function(params) {
                    return 'plots/' + params['ptype01'] + '_Block' + params['sample01'] + '_unc_' + params['unc01'] + '_mask_' + params['mask01'] +  '.png';

                });
                pager.setparams({
                    'ptype01': 'clkf',
                    'sample01': '2',
                    'unc01':'70',
                    'mask01': 'base',
                });
    </script>
    </figure>

<p>
    These results can be compared to the CMB lensing - filaments cross-power spectrum presented in He+18 and shown below. As we can see, they are in qualitative agreement.
</p>

<img src="plots/he18_clkf.png" alt="He18_clkf" >
<hr>

<h2>Cross-correlation with CMB Compton-$y$</h2>
We now move on to correlate the filaments overdensity maps with the <i>Planck</i> <code>NILC/MILCA</code> compton-$y$ maps. 
The MILCA and NILC maps have been found to be in good agreement in different studies, although the NILC map has a higher noise level on large scales.
In addition to the $C_{\ell}^{yf}$ cross-spectra we will also perform a rudimentary null test where we correlate a half-difference $y$-map 
constructed as $y^{-}=\frac{y^{\rm first}-y^{\rm last}}{2}$ with the filaments; this cross-spectrum is of course expected to be zero.

<figure>
    <img alt="yf pager" id="yf_pager" src="#" />
    <figcaption>
    Cross-power spectrum between Planck Compton-y maps (NILC/MILCA) and the filaments
    </figcaption>
    <script type="text/javascript">
        pager.link("#yf_pager",
            {
                'Plot type |ptype02': ['Spectrum|clyf', 'Corr coeff|clyf_corr', 'Null test|clynf'],
                'Sample|sample02': ['BOSS LOWZ|1', 'BOSS CMASS|2', 'BOSS+eBOSS (LRG and QSO)|3'],
                'Filaments uncertainty threshold|unc02': ['70', '100'],
                'Mask|mask02': ['base|base', 'base + SDSS redmapper clusts|base+redmapper5am'],
                'Y-map|ymap02': ['NILC|nilc', 'MILCA|milca'],
            },
            function (params) {
                return 'plots/' + params['ptype02'] + '_Block' + params['sample02'] + '_unc_' + params['unc02'] + '_mask_' + params['mask02'] + '_ymap_' + params['ymap02']+ '.png';

            });
        pager.setparams({
            'ptype02': 'clyf',
            'sample02': '2',
            'unc02': '70',
            'mask02': 'base',
            'ymap02': 'nilc',
        });
    </script>
</figure>

<hr>

<h2>Conclusions & Next Steps</h2>
<p>
We have measured the cross-correlation signal between filaments (from SDSS) and compton-$y$/CMB lensing maps (from <i>Planck</i>).
While we haven't properly estimated a significance of the detection, a non-null signal is seen in the LOWZ and CMASS cases, as also corroborated by the simple null test we performed on the $y$ maps.
</p>
<p>
The analysis presented here  
<ul>
    <li> Develop framework to interpret the measurement, would be cool to estimate some parameter like free electron fraction or the like</li>
    <li> Include compton-$y$ map inhomogenous weighting</li>
    <li> In principle it would be interesting to use simulations to validate the analysis and to estimate error bars (although that would likely require a filament detection machinery that we dont have) </li>
</ul>
</p>

<hr>

</article>
</main>
</div>
<script type="text/javascript">
    plupdate();
</script>
</body>
</html>
